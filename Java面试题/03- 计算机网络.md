## 互联网基本概念

### 什么是互联网

- 互联网改变了人们的生活方式（购物、聊天、看电影、买票、点外卖等）
    
- 计算机之间通过互联网相互通信
    
- 真实的互联网非常复杂，数据传输需要经过交换机、路由器等一系列设备
    

### 数据传输的核心问题

> 数据如何从一个设备传递到另一个设备？

**答案：由网络协议来规定**

- 规定数据传输路径
    
- 规定数据格式要求
    
- 没有网络协议就没有今天的互联网
    

---

## 为什么要学习网络协议

1. **互联网基础** - 互联网、移动互联网都离不开网络协议
    
2. **开发必备** - HTTP是最常用的协议
    
3. **多种协议应用场景**：
    
    - HTTP/HTTPS - 普通网页请求
        
    - FTP - 文件操作（上传、下载、删除、重命名）
        
    - RTMP - 流媒体/直播
        
    - SMTP - 电子邮件
        
    - MQTT - 物联网通讯
        
4. **面试高频考点**：
    
    - TCP与UDP的区别、报文格式
        
    - TCP流量控制、拥塞控制
        
    - TCP可靠性传输原理
        
    - 三次握手、四次挥手
        
    - 七层模型、四层模型、五层模型
        
    - 交换机与路由器的区别
        

---

## 开发环境搭建

### 需要的工具

#### 1. 浏览器（客户端）

- Chrome
    
- Firefox
    

#### 2. 抓包工具

- **Fiddler** - HTTP抓包
    
- **Wireshark** - 网络协议分析（logo是鲨鱼）
    

#### 3. 网络模拟工具

- **Cisco Packet Tracer** - 网络模拟
    
- **GNS3** - 专业网络模拟
    
- **ensp** (华为) - 仅Windows版本
    

#### 4. 服务器环境（Java）

- **JDK** - Java开发工具包（推荐JDK8）
    
- **Tomcat** - 服务器软件（推荐9.0版本）
    

---

## Java跨平台原理

### C/C++跨平台方式

源代码 → 针对不同平台编译 → 不同格式的可执行文件

- Mac系统：Mach-O格式
    
- Windows系统：PE格式（Portable Executable）
    
- Linux系统：ELF格式
    

**特点**：需要针对不同平台多次编译

### Java跨平台方式

源代码(.java) → 编译一次 → 字节码文件(.class) → JVM解析执行

**核心概念**：

- **JVM**（Java Virtual Machine）- Java虚拟机，负责解析字节码
    
- **JRE**（Java Runtime Environment）- Java运行环境，包含JVM
    
- **JDK**（Java Development Kit）- Java开发工具包，包含JRE
    

**特点**：一次编译，到处运行（Write Once, Run Anywhere）

### 与解释型语言对比

JavaScript等解释型语言更进一步：

- 不需要编译
    
- 由浏览器（V8引擎）直接解析执行
    
- 最终也会转换为机器指令（0和1）
    

---

## 客户端-服务器架构

### 基本概念

┌─────────────┐                    ┌─────────────────────┐  
│   客户端     │  ←── 互联网 ──→   │      服务器          │  
│  (浏览器等)  │                    │  (处理请求返回数据)   │  
└─────────────┘                    └─────────────────────┘

客户端类型：

- 移动开发（iOS、Android）
    
- 前端开发（Web浏览器）
    
- 嵌入式开发
    

### 端口（Port）概念

- 类似营业厅的办事窗口
    
- 用于监听网络数据
    
- 常见端口：80（HTTP）、8080（Tomcat默认）、3306（MySQL）
    

### 服务器软件的作用

1. 占用某个端口
    
2. 监听该端口的网络数据
    
3. 执行开发人员编写的代码
    
4. 返回响应数据给客户端
    

### 项目部署

一个服务器软件可以部署多个项目：

服务器软件(端口8080)  
    ├── QQ项目  
    ├── 微信项目  
    └── 王者荣耀项目

---

## URL访问格式

### 完整格式

http://IP地址:端口号/项目名/资源路径?参数

### 示例

http://192.168.128.45:8080/QQ/image/1.png  
http://localhost:8080/QQ/login?username=xxx

### 各部分作用

|组成部分|作用|
|---|---|
|IP地址|定位服务器机器|
|端口号|定位服务器软件|
|项目名|定位具体项目|
|资源路径|定位项目内资源|

### 本机访问方式

- `127.0.0.1` - 本地回环地址
    
- `localhost` - 本地主机
    

---

## 网络协议的重要性

### 为什么需要协议

类比租房协议：

- 约束双方行为
    
- 规定数据格式
    
- 减少沟通成本
    

### 没有标准的问题

如果每个公司都有自己的网络协议：

- 客户端需要针对不同服务器编写不同代码
    
- 互联网无法高效发展
    
- 设备间无法有效沟通
    

### 解决方案：国际标准

**ISO**（国际标准化组织）在1985年制定了网络互联模型

---

## OSI参考模型与TCP/IP模型

### OSI七层模型（理论标准）

┌─────────────┐  
│   应用层     │  ← 第7层  
├─────────────┤  
│   表示层     │  ← 第6层  
├─────────────┤  
│   会话层     │  ← 第5层  
├─────────────┤  
│   传输层     │  ← 第4层  
├─────────────┤  
│   网络层     │  ← 第3层  
├─────────────┤  
│  数据链路层  │  ← 第2层  
├─────────────┤  
│   物理层     │  ← 第1层  
└─────────────┘

### TCP/IP四层模型（实际应用）

┌─────────────┐  
│   应用层     │  ← 合并OSI上三层  
├─────────────┤  
│   传输层     │  
├─────────────┤  
│   网络层     │  （也叫网际层）  
├─────────────┤  
│  网络接口层  │  ← 合并OSI下两层   
└─────────────┘

### 五层模型（学习研究用）

┌─────────────┐  
│   应用层     │  
├─────────────┤  
│   传输层     │  
├─────────────┤  
│   网络层     │  
├─────────────┤  
│  数据链路层  │  
├─────────────┤  
│   物理层     │  
└─────────────┘

---

## 数据传输过程（封装与解封装）

### 发送端（封装过程）

原始数据："你好"  
    ↓  
应用层：添加应用层头部  
    ↓  
传输层：添加传输层头部  
    ↓  
网络层：添加网络层头部  
    ↓  
数据链路层：添加头部和尾部  
    ↓  
物理层：添加物理层头部  
    ↓  
通过传输介质（网线/WiFi）发送

### 接收端（解封装过程）

接收数据  
    ↓  
物理层：去除物理层头部  
    ↓  
数据链路层：去除头部和尾部  
    ↓  
网络层：去除网络层头部  
    ↓  
传输层：去除传输层头部  
    ↓  
应用层：获得原始数据"你好"

### 关键点

- 不管使用什么应用层协议（HTTP、FTP、MQTT、RTMP等），都遵循这个分层封装/解封装过程
    
- 每一层都有其特定的功能和作用
    

---

## 推荐资源

- 《计算机网络》- 大学教材
    
- 《TCP/IP详解》

**0921**

---
---

## 计算机通信基础

### 通信必要条件

1. **IP地址** - 定位目标计算机
    
2. **MAC地址** - 定位目标网卡
    

> 只有IP地址是不够的，最终需要MAC地址才能将数据送达网卡

### MAC地址（网卡地址）

- 每个网卡都有唯一的MAC地址
    
- 网卡接收数据后，检查目标MAC地址是否是自己
    
    - 是：传递给上层处理
        
    - 否：丢弃数据包
        

### ARP协议（地址解析协议）

**作用**：根据IP地址获取对应的MAC地址

**工作原理**：

1. 发送ARP广播请求："谁知道 192.168.1.11 的MAC地址？"
    
2. 同网段所有设备都会收到广播
    
3. 目标设备回复自己的MAC地址
    
4. 发送方缓存MAC地址（可用 `arp -a` 查看缓存）
    

**广播MAC地址**：`FF:FF:FF:FF:FF:FF`（全1）表示广播，同网段所有网卡都能接收

### 数据包结构

┌─────────────────────────────────────────────────────────────┐  
│  源IP地址  │  目标IP地址  │  源MAC地址  │  目标MAC地址  │  数据  │  
└─────────────────────────────────────────────────────────────┘

---

## 计算机连接方式

### 1. 直连（交叉线）

两台电脑直接用网线连接：

- 使用**交叉线**（相同设备用交叉线）
    
- 必须在同一网段才能通信
    

┌────────┐  交叉线  ┌────────┐  
│  PC1   │─────────│  PC2   │  
└────────┘         └────────┘

### 2. 同轴电缆（已淘汰）

终结电阻 ──┬──┬──┬──┬── 终结电阻  ┬型头进行连接  
          │  │  │  │  
         PC PC PC PC

**特点**：

- ❌ 半双工通信（同一时间只能单向传输）
    
- ❌ 没有智商，信号向两边扩散
    
- ❌ 容易冲突
    
- ❌ 中间断开整个网络瘫痪
    
- ❌ 不安全（所有设备都能收到数据）
    

### 3. 集线器（Hub）

        ┌─────────┐  
   ┌────┤   Hub   ├────┐  
   │    └────┬────┘    │  
   │         │         │  
  PC1       PC2       PC3

**特点**：

- ❌ 半双工通信
    
- ❌ 没有智商，收到数据向所有端口转发
    
- ❌ 容易冲突（大冲突域）
    
- ❌ 不安全
    
- ✅ 比同轴电缆好：单个端口故障不影响其他设备
    

**集线器级联**：

┌─────┐     ┌─────┐  
│ Hub ├─────┤ Hub │  
└──┬──┘     └──┬──┘  
   │           │  
  PC          PC

- 相同设备之间用**交叉线**
    
- 不同设备之间用**直通线**
    

### 4. 网桥（Bridge）

┌─────┐         ┌─────┐  
│ Hub ├─────────┤ Hub │  
└──┬──┘  网桥   └──┬──┘  
   │             │  
  PC            PC

**特点**：

- ✅ 有智商，能学习
    
- ✅ 维护MAC地址表（记录左右两侧的MAC地址）
    
- ✅ 隔绝冲突域
    
- ❌ 只有两个端口
    

**MAC地址表**：

|端口|MAC地址|
|---|---|
|左侧|PC1, PC2|
|右侧|PC3, PC4|

**工作原理**：

1. 通过数据包的源MAC地址学习各端口连接的设备
    
2. 如果目标MAC在同侧，不转发到另一侧
    
3. 如果目标MAC在另一侧或未知，转发到另一侧
    

### 5. 交换机（Switch）⭐

        ┌──────────┐  
   ┌────┤  Switch  ├────┐  
   │    └────┬─────┘    │  
   │         │          │  
  PC1       PC2        PC3

**特点**：

- ✅ **全双工通信**（可同时收发）
    
- ✅ 有智商，能学习每个端口的MAC地址
    
- ✅ 多端口（比网桥端口多）
    
- ✅ 精准转发（只发给目标设备）
    
- ✅ 安全（数据不会发给无关设备）
    
- ✅ 每个端口是独立的冲突域
    

**交换机 = 多端口网桥 + 集线器功能 + 更高智商**

**工作原理**：

1. 学习每个端口连接设备的MAC地址
    
2. 建立MAC地址表
    
3. 收到数据包后，根据目标MAC地址精准转发到对应端口
    

**MAC地址表示例**：

|端口|MAC地址|
|---|---|
|1|AA:BB:CC:DD:EE:01|
|2|AA:BB:CC:DD:EE:02|
|3|AA:BB:CC:DD:EE:03|
|4|AA:BB:CC:DD:EE:04|

---

## 设备对比总结

|设备|智商|通信方式|冲突域|安全性|端口数|
|---|---|---|---|---|---|
|同轴电缆|❌ 无|半双工|大|低|-|
|集线器|❌ 无|半双工|大|低|多|
|网桥|✅ 有|半双工|隔绝为2个|中|2|
|交换机|✅ 有|全双工|每端口独立|高|多|

---

## 为什么需要路由器？

### 交换机的局限性

如果全球设备都用交换机连接：

1. **IP地址不够用** - 所有设备在同一网段
    
2. **广播风暴** - ARP广播会发给全球所有设备
    
3. **效率低下** - 大量无效数据传输
    

### 路由器的作用

- 连接**不同网段**
    
- 在不同网段之间**转发数据**
    
- **隔绝广播**（广播不会跨网段）
    

> 交换机：局域网最佳方案 路由器：跨网段通信必需

---

## Packet Tracer 模拟工具

### 常用设备

- **Switches** - 交换机
    
- **Routers** - 路由器
    
- **Hubs** - 集线器
    
- **End Devices** - 终端设备（PC、服务器等）
    

### 连线类型

- **直通线** - 不同设备之间（PC ↔ 交换机）
    
- **交叉线** - 相同设备之间（PC ↔ PC，交换机 ↔ 交换机）
    
- **自动选择** - 点击闪电图标自动选择
    

### 测试网络连通性

ping 192.168.1.11

### 查看ARP缓存

arp -a

### 仿真模式

- 可以一步步观察数据包传输过程
    
- 查看ARP、ICMP等协议的工作流程
    

---

## 关键概念

### 冲突域

- 同一时间只能有一个设备发送数据的区域
    
- 集线器：所有端口在同一冲突域
    
- 交换机：每个端口是独立的冲突域
    

### 广播域

- 广播能够到达的范围
    
- 交换机不能隔绝广播域
    
- 路由器可以隔绝广播域
    

### 网段

- 同一网段的设备可以直接通信
    
- 不同网段需要通过路由器通信
    
- 判断是否同一网段需要用**子网掩码**
    

---

## MAC地址（物理地址）

### 1.1 什么是MAC地址
  

MAC（Media Access Control）地址，也叫：

- 物理地址

- 硬件地址

- 以太网地址

- 网卡地址


**定义**：MAC地址是网卡的唯一标识符，由网卡厂商在生产时烧录到网卡中。
### 1.2 MAC地址格式


```

48位（6字节），通常用十六进制表示

  

格式：XX:XX:XX:XX:XX:XX 或 XX-XX-XX-XX-XX-XX

  

示例：00:1A:2B:3C:4D:5E

```


**组成结构**：

```

┌─────────────────────┬─────────────────────┐

│ 前24位（3字节） │ 后24位（3字节） │

│ OUI（厂商标识） │ 设备序列号 │

└─────────────────────┴─────────────────────┘

```

  

- **OUI**（Organizationally Unique Identifier）：由IEEE分配给厂商

- **设备序列号**：由厂商自行分配

  

### 1.3 特殊MAC地址

  

| MAC地址 | 含义 |

|---------|------|

| `FF:FF:FF:FF:FF:FF` | 广播地址（全1），同网段所有设备都能接收 |

| `00:00:00:00:00:00` | 无效地址 |

| 第一字节最低位为1 | 组播地址 |

  

### 1.4 MAC地址的作用

  

1. **数据链路层寻址** - 在局域网内精确定位目标设备

2. **网卡识别** - 网卡根据目标MAC判断是否接收数据包

3. **交换机转发** - 交换机根据MAC地址表进行精准转发

  

### 1.5 查看MAC地址

  

```bash

# Windows

ipconfig /all

  

# macOS / Linux

ifconfig

# 或

ip link show

```

  

---

  

## 二、IP地址（逻辑地址）

  

### 2.1 什么是IP地址

  

IP（Internet Protocol）地址是网络层的逻辑地址，用于在互联网中唯一标识一台设备。

  

**与MAC地址的区别**：

| 特性 | MAC地址 | IP地址 |

|------|---------|--------|

| 层级 | 数据链路层 | 网络层 |

| 类型 | 物理地址 | 逻辑地址 |

| 分配 | 厂商烧录 | 手动/DHCP分配 |

| 可变性 | 固定不变 | 可以更改 |

| 作用范围 | 局域网内 | 跨网络通信 |

  

### 2.2 IPv4地址格式

  

```

32位（4字节），用点分十进制表示

  

格式：X.X.X.X（每个X范围：0-255）

  

示例：192.168.1.100

```

  

**二进制表示**：

```

192.168.1.100

= 11000000.10101000.00000001.01100100

```

  

### 2.3 IP地址的组成

  

```

┌─────────────────────┬─────────────────────┐

│ 网络部分 │ 主机部分 │

│ （Network ID） │ （Host ID） │

└─────────────────────┴─────────────────────┘

```

  

- **网络部分**：标识设备所在的网络

- **主机部分**：标识网络中的具体设备

  

### 2.4 IP地址分类（传统分类）

  

| 类别 | 范围 | 网络位 | 主机位 | 默认子网掩码 |

|------|------|--------|--------|--------------|

| A类 | 1.0.0.0 ~ 126.255.255.255 | 8位 | 24位 | 255.0.0.0 |

| B类 | 128.0.0.0 ~ 191.255.255.255 | 16位 | 16位 | 255.255.0.0 |

| C类 | 192.0.0.0 ~ 223.255.255.255 | 24位 | 8位 | 255.255.255.0 |

| D类 | 224.0.0.0 ~ 239.255.255.255 | 组播地址 | - | - |

| E类 | 240.0.0.0 ~ 255.255.255.255 | 保留地址 | - | - |

  

### 2.5 特殊IP地址

  

| IP地址 | 含义 |

|--------|------|

| `127.0.0.1` | 本地回环地址（localhost） |

| `0.0.0.0` | 任意地址/无效地址 |

| `255.255.255.255` | 广播地址 |

| `x.x.x.0` | 网络地址（主机位全0） |

| `x.x.x.255` | 广播地址（主机位全1，C类网络） |

  

### 2.6 私有IP地址（内网地址）

  

| 类别 | 私有地址范围 |

|------|--------------|

| A类 | 10.0.0.0 ~ 10.255.255.255 |

| B类 | 172.16.0.0 ~ 172.31.255.255 |

| C类 | 192.168.0.0 ~ 192.168.255.255 |

  

> 私有IP地址只能在局域网内使用，不能直接访问互联网

  

### 2.7 查看IP地址

  

```bash

# Windows

ipconfig

  

# macOS / Linux

ifconfig

# 或

ip addr show

```

  

---

  

## 三、子网掩码（Subnet Mask）

  

### 3.1 什么是子网掩码

  

子网掩码用于区分IP地址中的**网络部分**和**主机部分**。

  

**作用**：

1. 划分网络和主机

2. 判断两个IP是否在同一网段

3. 实现子网划分

  

### 3.2 子网掩码格式

  

```

32位，与IP地址一一对应

  

规则：网络位全为1，主机位全为0

  

示例：255.255.255.0

= 11111111.11111111.11111111.00000000

```

  

### 3.3 常见子网掩码

  

| 子网掩码 | CIDR表示 | 网络位 | 主机位 | 可用主机数 |

|----------|----------|--------|--------|------------|

| 255.0.0.0 | /8 | 8 | 24 | 16,777,214 |

| 255.255.0.0 | /16 | 16 | 16 | 65,534 |

| 255.255.255.0 | /24 | 24 | 8 | 254 |

| 255.255.255.128 | /25 | 25 | 7 | 126 |

| 255.255.255.192 | /26 | 26 | 6 | 62 |

| 255.255.255.224 | /27 | 27 | 5 | 30 |

| 255.255.255.240 | /28 | 28 | 4 | 14 |

| 255.255.255.248 | /29 | 29 | 3 | 6 |

| 255.255.255.252 | /30 | 30 | 2 | 2 |

  

> 可用主机数 = 2^主机位 - 2（减去网络地址和广播地址）

  

### 3.4 CIDR表示法

  

CIDR（Classless Inter-Domain Routing）无类别域间路由

  

```

格式：IP地址/网络位数

  

示例：192.168.1.0/24

表示前24位是网络部分

```

  

---

  

## 四、判断是否在同一网段

  

### 4.1 计算方法

  

**公式**：IP地址 AND 子网掩码 = 网络地址

  

如果两个IP的网络地址相同，则在同一网段。

  

### 4.2 计算示例

  

**判断 192.168.1.10 和 192.168.1.20 是否在同一网段（子网掩码：255.255.255.0）**

  

```

IP1: 192.168.1.10

11000000.10101000.00000001.00001010

AND

掩码: 255.255.255.0

11111111.11111111.11111111.00000000

=

网络: 192.168.1.0

11000000.10101000.00000001.00000000

  

IP2: 192.168.1.20

11000000.10101000.00000001.00010100

AND

掩码: 255.255.255.0

11111111.11111111.11111111.00000000

=

网络: 192.168.1.0

11000000.10101000.00000001.00000000

  

结论：网络地址相同（192.168.1.0），在同一网段 ✓

```

  

### 4.3 不同网段示例

  

**判断 192.168.1.10 和 192.168.2.10 是否在同一网段（子网掩码：255.255.255.0）**

  

```

IP1 AND 掩码 = 192.168.1.0

IP2 AND 掩码 = 192.168.2.0

  

结论：网络地址不同，不在同一网段 ✗

```

  

---

  

## 五、子网划分

  

### 5.1 为什么要划分子网

  

1. **减少广播域** - 广播只在子网内传播

2. **提高安全性** - 不同子网间需要路由器转发

3. **优化IP地址使用** - 避免IP地址浪费

4. **便于管理** - 按部门/功能划分网络

  

### 5.2 子网划分示例

  

**将 192.168.1.0/24 划分为4个子网**

  

```

原网络：192.168.1.0/24（254个可用主机）

  

借用2位主机位作为子网位：/24 → /26

  

子网1：192.168.1.0/26 （可用：1-62）

子网2：192.168.1.64/26 （可用：65-126）

子网3：192.168.1.128/26 （可用：129-190）

子网4：192.168.1.192/26 （可用：193-254）

  

每个子网可用主机数：2^6 - 2 = 62

```

  

---

  

## 六、MAC地址与IP地址的协作

  

### 6.1 通信过程

  

```

┌─────────────────────────────────────────────────────────┐

│ 发送数据 │

├─────────────────────────────────────────────────────────┤

│ 1. 应用层产生数据 │

│ 2. 网络层添加源IP和目标IP │

│ 3. 判断目标IP是否在同一网段 │

│ - 同网段：通过ARP获取目标MAC │

│ - 不同网段：通过ARP获取网关MAC │

│ 4. 数据链路层添加源MAC和目标MAC │

│ 5. 物理层发送 │

└─────────────────────────────────────────────────────────┘

```

  

### 6.2 同网段通信

  

```

PC1 (192.168.1.10) → PC2 (192.168.1.20)

  

1. PC1判断：目标IP在同一网段

2. PC1发送ARP广播：谁是192.168.1.20？

3. PC2回复：我是，我的MAC是XX:XX:XX:XX:XX:XX

4. PC1直接发送数据给PC2的MAC地址

```

  

### 6.3 跨网段通信

  

```

PC1 (192.168.1.10) → PC3 (192.168.2.10)

  

1. PC1判断：目标IP不在同一网段

2. PC1发送ARP广播：谁是网关192.168.1.1？

3. 路由器回复：我是，我的MAC是XX:XX:XX:XX:XX:XX

4. PC1将数据发给路由器的MAC地址

5. 路由器根据路由表转发到目标网段

6. 路由器发送ARP获取PC3的MAC地址

7. 路由器将数据发给PC3

```

  

---

  

## 七、网关（Gateway）

  

### 7.1 什么是网关

  

网关是连接不同网段的设备（通常是路由器），是数据离开本网段的"出口"。

  

### 7.2 网关的作用

  

1. **跨网段转发** - 将数据包转发到其他网段

2. **路由选择** - 根据路由表选择最佳路径

3. **协议转换** - 在不同网络协议间转换

  

### 7.3 默认网关

  

- 当目标IP不在本网段时，数据发送给默认网关

- 默认网关通常是路由器在本网段的IP地址

- 例如：192.168.1.1

  

---

  

## 八、总结对比

  

| 概念 | 作用 | 层级 | 示例 |

|------|------|------|------|

| MAC地址 | 局域网内设备标识 | 数据链路层 | 00:1A:2B:3C:4D:5E |

| IP地址 | 网络中设备标识 | 网络层 | 192.168.1.100 |

| 子网掩码 | 区分网络和主机 | 网络层 | 255.255.255.0 |

| 网关 | 跨网段通信出口 | 网络层 | 192.168.1.1 |

  

---

  

## 九、实践命令

  

### Windows

```bash

# 查看网络配置

ipconfig /all

  

# 查看ARP缓存

arp -a

  

# 清除ARP缓存

arp -d

  

# 测试连通性

ping 192.168.1.1

  

# 查看路由表

route print

```

  

### macOS / Linux

```bash

# 查看网络配置

ifconfig

ip addr show

  

# 查看ARP缓存

arp -a

  

# 测试连通性

ping 192.168.1.1

  

# 查看路由表

netstat -rn

ip route show

```

  

---

  

## 十、常见面试题

  

1. **MAC地址和IP地址有什么区别？**

2. **如何判断两个IP是否在同一网段？**

3. **子网掩码的作用是什么？**

4. **为什么需要ARP协议？**

5. **同网段通信和跨网段通信有什么区别？**

6. **什么是默认网关？**

7. **私有IP地址有哪些范围？**

8. **192.168.1.0/24 可以容纳多少台主机？**


## 路由器（Router）

### 1.1 为什么需要路由器？

如果全球设备都用交换机连接会出现什么问题？

1. **广播风暴** - 所有设备在同一网段，ARP广播会发给全球所有设备
    
2. **IP地址不够用** - 所有设备必须在同一网段
    
3. **网络效率低下** - 大量无效广播占用带宽
    

### 1.2 交换机 vs 路由器

|特性|交换机|路由器|
|---|---|---|
|连接设备要求|必须在同一网段|可以连接不同网段|
|广播处理|转发广播|**隔绝广播域**|
|工作层级|数据链路层|网络层|
|主要作用|同网段内转发数据|跨网段转发数据|

### 1.3 路由器的作用

1. **隔绝广播域** - 广播不会跨越路由器传播
    
2. **跨网段转发数据** - 在不同网段之间转发数据包
    
3. **路由选择** - 根据路由表选择最佳路径
    

### 1.4 网关（Gateway）

**什么是网关？**

- 网关是数据离开本网段的"出口"
    
- 通常是路由器在本网段的接口IP地址
    
- 每个网段都有自己的网关（路由器的网关）
    

**路由器接口特点**：

- 每个接口都有独立的MAC地址和IP地址
    
- 每个接口对应一个网段
    
- 接口IP必须与所连网段在同一网段
    

**网络拓扑示例**：

┌─────────────────────────────────────────────────────────────┐  
│                        路由器                                │  
│  ┌─────────────┐                      ┌─────────────┐       │  
│  │ 接口 FA0/0  │                      │ 接口 FA0/1  │       │  
│  │ 192.168.3.1 │                      │ 192.168.4.1 │       │  
│  └──────┬──────┘                      └──────┬──────┘       │  
└─────────┼────────────────────────────────────┼──────────────┘  
          │                                    │  
    ┌─────┴─────┐                        ┌─────┴─────┐  
    │  交换机   │                        │  交换机   │  
    └─────┬─────┘                        └─────┬─────┘  
          │                                    │  
   ┌──────┴──────┐                      ┌──────┴──────┐  
   │             │                      │             │  
192.168.3.10  192.168.3.11         192.168.4.10  192.168.4.11

### 1.5 跨网段通信过程

**场景**：192.168.3.10 → 192.168.4.11

1. 主机判断：目标IP不在同一网段  
   ↓  
2. 发送ARP广播获取网关(192.168.3.1)的MAC地址  
   ↓  
3. 将数据发送到网关（路由器FA0/0接口）  
   ↓  
4. 路由器查看目标IP，确定从FA0/1接口转发  
   ↓  
5. 路由器发送ARP广播获取目标主机(192.168.4.11)的MAC地址  
   ↓  
6. 路由器将数据转发给目标主机

**关键点**：

- 主机发数据前会判断目标是否在同一网段
    
- 同网段：直接ARP获取目标MAC，通过交换机发送
    
- 不同网段：ARP获取网关MAC，发送给路由器转发
    

---

## 二、MAC地址（物理地址）

### 2.1 什么是MAC地址

MAC（Media Access Control）地址，也叫：

- 物理地址
    
- 硬件地址
    
- 网卡地址
    

**特点**：

- 全球唯一，固化在网卡ROM中
    
- 由IEEE 802标准规定
    
- 网卡厂商在生产时烧录
    

### 2.2 MAC地址格式

48位（6字节），用十六进制表示  
​  
格式（不同系统表示不同）：  
- Windows: 00-1A-2B-3C-4D-5E（减号分隔）  
- Linux/macOS: 00:1A:2B:3C:4D:5E（冒号分隔）  
- Packet Tracer: 001A.2B3C.4D5E（点分隔）

**组成结构**：

┌─────────────────────┬─────────────────────┐  
│   前24位（3字节）    │   后24位（3字节）    │  
│   OUI（厂商标识）    │   设备序列号         │  
└─────────────────────┴─────────────────────┘

- **OUI**（Organizationally Unique Identifier）：由IEEE分配给厂商
    
- **设备序列号**：由厂商自行分配
    

### 2.3 特殊MAC地址

|MAC地址|含义|
|---|---|
|`FF:FF:FF:FF:FF:FF`|广播地址（48位全1），同网段所有设备都能接收|
|`00:00:00:00:00:00`|无效地址|

### 2.4 查看与修改MAC地址

# Windows - 查看MAC地址  
ipconfig /all  
​  
# macOS / Linux  
ifconfig  
ip link show

**修改MAC地址**（Windows）：

- 网络适配器 → 属性 → 配置 → 高级 → 网络地址
    
- 可以临时修改MAC地址（不影响网卡内部固化的地址）
    

**应用场景**：某些网络环境通过MAC地址白名单控制上网权限

### 2.5 ARP缓存

# 查看ARP缓存  
arp -a  
​  
# 删除所有ARP缓存  
arp -d  
​  
# 删除指定条目  
arp -d 192.168.1.12  
​  
# 添加静态ARP条目（需管理员权限）  
arp -s 192.168.1.10 00-11-22-33-44-55

**缓存类型**：

- **Dynamic（动态）**：通过ARP协议学习，默认2分钟过期
    
- **Static（静态）**：手动添加，存储时间较长
    

---

## 三、IP地址（逻辑地址）

### 3.1 IPv4地址格式

32位（4字节），用点分十进制表示  
​  
格式：X.X.X.X（每个X范围：0-255）  
​  
示例：192.168.1.100  
二进制：11000000.10101000.00000001.01100100

### 3.2 IP地址的组成

┌─────────────────────┬─────────────────────┐  
│      网络ID          │      主机ID          │  
│   （Network ID）     │    （Host ID）       │  
└─────────────────────┴─────────────────────┘

- **网络ID**：标识设备所在的网络（网段）
    
- **主机ID**：标识网络中的具体设备
    

### 3.3 特殊IP地址

|IP地址|含义|
|---|---|
|`127.0.0.1`|本地回环地址（localhost），用于测试本机网络|
|`0.0.0.0`|任意地址/无效地址|
|主机ID全0|网络地址，代表整个网段|
|主机ID全1|广播地址，发送给网段内所有主机|

---

## 四、子网掩码（Subnet Mask）

### 4.1 什么是子网掩码

子网掩码用于区分IP地址中的**网络ID**和**主机ID**。

**计算公式**：

IP地址 AND (&) 子网掩码 = 网络地址（网段）

### 4.2 计算示例

IP地址:    192.168.1.10  
           11000000.10101000.00000001.00001010  
AND  
子网掩码:  255.255.255.0  
           11111111.11111111.11111111.00000000  
=  
网络地址:  192.168.1.0  
           11000000.10101000.00000001.00000000

**规则**：

- 与1进行AND运算 → 保留原值
    
- 与0进行AND运算 → 结果为0
    

### 4.3 CIDR表示法

格式：IP地址/网络位数  
​  
示例：  
192.168.1.10/24  →  子网掩码有24个1  →  255.255.255.0  
172.16.0.1/16    →  子网掩码有16个1  →  255.255.0.0  
10.0.0.1/8       →  子网掩码有8个1   →  255.0.0.0

### 4.4 判断是否在同一网段

**方法**：分别计算两个IP的网络地址，相同则在同一网段

IP1: 192.168.1.10/24  →  网络地址: 192.168.1.0  
IP2: 192.168.1.80/24  →  网络地址: 192.168.1.0  
结论：同一网段 ✓  
​  
IP1: 192.168.1.10/24  →  网络地址: 192.168.1.0  
IP2: 192.168.2.10/24  →  网络地址: 192.168.2.0  
结论：不同网段 ✗

---

## 五、IP地址分类

### 5.1 五类IP地址

|类别|第一字节范围|网络位|主机位|默认子网掩码|开头二进制|
|---|---|---|---|---|---|
|A类|1-126|8位|24位|255.0.0.0 (/8)|0xxxxxxx|
|B类|128-191|16位|16位|255.255.0.0 (/16)|10xxxxxx|
|C类|192-223|24位|8位|255.255.255.0 (/24)|110xxxxx|
|D类|224-239|-|-|无|1110xxxx|
|E类|240-255|-|-|无|1111xxxx|

**注意**：

- 只有A、B、C类可以分配给主机
    
- D类用于组播/多播
    
- E类保留未使用
    
- A类中0和127保留（127.x.x.x为本地回环地址）
    

### 5.2 各类地址容量

|类别|可用网络数|每网段可用主机数|
|---|---|---|
|A类|126 (1-126)|2^24 - 2 = 16,777,214|
|B类|16,384|2^16 - 2 = 65,534|
|C类|2,097,152|2^8 - 2 = 254|

### 5.3 私有IP地址

|类别|私有地址范围|
|---|---|
|A类|10.0.0.0 ~ 10.255.255.255|
|B类|172.16.0.0 ~ 172.31.255.255|
|C类|192.168.0.0 ~ 192.168.255.255|

---

## 六、子网划分

### 6.1 为什么要子网划分？

**问题场景**：需要500台主机在同一网段

- C类网段：最多254台 → 不够用
    
- B类网段：最多65534台 → 太浪费（多出65000+空闲IP）
    

**解决方案**：子网划分 - 借用主机位作为子网位

### 6.2 等长子网划分

将一个网段等分成多个子网，每个子网可用IP数量相同。

**原理**：子网掩码向右移动n位 → 划分成2^n个子网

#### 示例1：二等分（/24 → /25）

原网段：192.168.0.0/24（可容纳254台主机）

原子网掩码：11111111.11111111.11111111.00000000 (/24)  
新子网掩码：11111111.11111111.11111111.10000000 (/25)  
                                        ↑  
                                    借用1位主机位

划分结果：

|子网|网络地址|可用IP范围|广播地址|可用主机数|
|---|---|---|---|---|
|A子网|192.168.0.0/25|192.168.0.1 ~ 192.168.0.126|192.168.0.127|126|
|B子网|192.168.0.128/25|192.168.0.129 ~ 192.168.0.254|192.168.0.255|126|

#### 示例2：四等分（/24 → /26）

原网段：192.168.0.0/24

新子网掩码：11111111.11111111.11111111.11000000 (/26)  
                                        ↑↑  
                                    借用2位主机位

划分结果：

|子网|网络地址|可用IP范围|广播地址|可用主机数|
|---|---|---|---|---|
|A子网|192.168.0.0/26|192.168.0.1 ~ 192.168.0.62|192.168.0.63|62|
|B子网|192.168.0.64/26|192.168.0.65 ~ 192.168.0.126|192.168.0.127|62|
|C子网|192.168.0.128/26|192.168.0.129 ~ 192.168.0.190|192.168.0.191|62|
|D子网|192.168.0.192/26|192.168.0.193 ~ 192.168.0.254|192.168.0.255|62|

### 6.3 子网划分规律

|借用位数|子网数量|每子网主机数（C类）|
|---|---|---|
|1位|2|126|
|2位|4|62|
|3位|8|30|
|4位|16|14|
|5位|32|6|
|6位|64|2|

**公式**：

- 子网数量 = 2^借用位数
    
- 每子网可用主机数 = 2^剩余主机位 - 2
    

### 6.4 变长子网划分（VLSM）

不等分网段，根据实际需求划分不同大小的子网。

例：从一个B类网段划分出：  
- 子网1：128个IP  
- 子网2：256个IP    
- 子网3：几千个IP

### 6.5 子网划分实验

**验证不同子网无法直接通信**：

设备1：192.168.0.10/25  → 网段：192.168.0.0/25（0-127范围）  
设备2：192.168.0.200/25 → 网段：192.168.0.128/25（128-255范围）  
​  
结果：ping不通，因为在不同子网  
解决：中间加路由器，配置对应网关

---

## 七、通信过程总结

### 7.1 同网段通信

PC1 (192.168.1.10) → PC2 (192.168.1.20)  
​  
1. PC1判断：目标IP在同一网段  
2. PC1发送ARP广播：谁是192.168.1.20？  
3. PC2回复：我是，我的MAC是XX:XX:XX:XX:XX:XX  
4. PC1直接发送数据给PC2的MAC地址

### 7.2 跨网段通信

PC1 (192.168.3.10) → PC3 (192.168.4.11)  
​  
1. PC1判断：目标IP不在同一网段  
2. PC1发送ARP广播：谁是网关192.168.3.1？  
3. 路由器回复网关MAC地址  
4. PC1将数据发给路由器  
5. 路由器发送ARP获取PC3的MAC地址  
6. 路由器将数据转发给PC3

---

## 八、实践命令

### Windows

# 查看网络配置（包含MAC地址）  
ipconfig /all  
​  
# 查看ARP缓存  
arp -a  
​  
# 清除ARP缓存  
arp -d  
​  
# 测试连通性  
ping 192.168.1.1  
​  
# 测试广播（ping网段内所有主机）  
ping 192.168.1.255  
​  
# 查看路由表  
route print

### macOS / Linux

# 查看网络配置  
ifconfig  
ip addr show  
​  
# 查看ARP缓存  
arp -a  
​  
# 测试连通性  
ping 192.168.1.1  
​  
# 查看路由表  
netstat -rn  
ip route show

---

## 九、常见面试题

1. **MAC地址和IP地址有什么区别？**
    
2. **如何判断两个IP是否在同一网段？**
    
3. **子网掩码的作用是什么？**
    
4. **为什么需要ARP协议？**
    
5. **同网段通信和跨网段通信有什么区别？**
    
6. **什么是默认网关？**
    
7. **路由器和交换机的区别？**
    
8. **什么是广播风暴？如何避免？**
    
9. **192.168.1.0/24 可以容纳多少台主机？**
    
10. **如何将一个C类网段划分成4个子网？**
    
11. **为什么主机ID不能全0或全1？**
    
12. **A类、B类、C类地址如何区分？**
    
    ---
    
    ## 十、关键概念总结
    
    |概念|作用|层级|示例|
    |---|---|---|---|
    |MAC地址|局域网内设备标识|数据链路层|00:1A:2B:3C:4D:5E|
    |IP地址|网络中设备标识|网络层|192.168.1.100|
    |子网掩码|区分网络ID和主机ID|网络层|255.255.255.0 (/24)|
    |网关|跨网段通信出口|网络层|192.168.1.1|
    |交换机|同网段数据转发|数据链路层|-|
    |路由器|跨网段数据转发|网络层|-|